"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const bigint_buffer_1 = require("bigint-buffer");
const utils_1 = require("../../utils");
class Sha3Op {
    constructor() {
        this.code = 0x20;
        this.mnemonic = 'SHA3';
        this.description = 'Compute Keccak-256 hash';
        this.gas = 30;
        this.bytes = 1;
    }
    toString(params) {
        return `${this.mnemonic}`;
    }
    handle(context) {
        const address = context.stack.pop();
        const length = context.stack.pop();
        const data = context.memory.loadN(address, Number(length));
        const result = bigint_buffer_1.toBigIntBE(Buffer.from(utils_1.sha3(data).slice(2), 'hex'));
        context.stack.push(result);
        context.ip += this.bytes;
    }
}
exports.Sha3 = new Sha3Op();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhMy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ldm0vb3Bjb2Rlcy9zaGEzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaURBQTJDO0FBRTNDLHVDQUFtQztBQUduQyxNQUFNLE1BQU07SUFBWjtRQUNrQixTQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ1osYUFBUSxHQUFHLE1BQU0sQ0FBQztRQUNsQixnQkFBVyxHQUFHLHlCQUF5QixDQUFDO1FBQ3hDLFFBQUcsR0FBRyxFQUFFLENBQUM7UUFDVCxVQUFLLEdBQUcsQ0FBQyxDQUFDO0lBYzVCLENBQUM7SUFaUSxRQUFRLENBQUMsTUFBYztRQUM1QixPQUFPLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFTSxNQUFNLENBQUMsT0FBbUI7UUFDL0IsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUcsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRyxDQUFDO1FBQ3BDLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMzRCxNQUFNLE1BQU0sR0FBRywwQkFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ25FLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzNCLE9BQU8sQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQztJQUMzQixDQUFDO0NBQ0Y7QUFFWSxRQUFBLElBQUksR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDIn0=