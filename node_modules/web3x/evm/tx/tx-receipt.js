"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const bigint_buffer_1 = require("bigint-buffer");
const bn_js_1 = tslib_1.__importDefault(require("bn.js"));
const rlp = tslib_1.__importStar(require("rlp"));
const address_1 = require("../../address");
function serializeTxReceipt(txReceipt) {
    const { cumulativeGasUsed, logs, logsBloomFilter, status } = txReceipt;
    return rlp.encode([
        status ? new bn_js_1.default(1) : new bn_js_1.default(0),
        bigint_buffer_1.toBufferBE(cumulativeGasUsed, 32),
        logsBloomFilter,
        logs.map(log => [log.address.toBuffer(), log.topics, log.data]),
    ]);
}
exports.serializeTxReceipt = serializeTxReceipt;
function deserializeTxReceipt(data) {
    const bufs = rlp.decode(data);
    const logs = bufs[3];
    return {
        status: bigint_buffer_1.toBigIntBE(bufs[0]) > 0,
        cumulativeGasUsed: bigint_buffer_1.toBigIntBE(bufs[1]),
        logsBloomFilter: bufs[2],
        logs: logs.map(logBufs => ({
            address: new address_1.Address(logBufs[0]),
            topics: logBufs[1],
            data: logBufs[2],
        })),
    };
}
exports.deserializeTxReceipt = deserializeTxReceipt;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHgtcmVjZWlwdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ldm0vdHgvdHgtcmVjZWlwdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxpREFBdUQ7QUFDdkQsMERBQXVCO0FBQ3ZCLGlEQUEyQjtBQUMzQiwyQ0FBd0M7QUFVeEMsU0FBZ0Isa0JBQWtCLENBQUMsU0FBb0I7SUFDckQsTUFBTSxFQUFFLGlCQUFpQixFQUFFLElBQUksRUFBRSxlQUFlLEVBQUUsTUFBTSxFQUFFLEdBQUcsU0FBUyxDQUFDO0lBQ3ZFLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztRQUNoQixNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksZUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLGVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDOUIsMEJBQVUsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLENBQUM7UUFDakMsZUFBZTtRQUNmLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDaEUsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQVJELGdEQVFDO0FBRUQsU0FBZ0Isb0JBQW9CLENBQUMsSUFBWTtJQUMvQyxNQUFNLElBQUksR0FBYSxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBUSxDQUFDO0lBQy9DLE1BQU0sSUFBSSxHQUFlLElBQUksQ0FBQyxDQUFDLENBQVEsQ0FBQztJQUN4QyxPQUFPO1FBQ0wsTUFBTSxFQUFFLDBCQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUMvQixpQkFBaUIsRUFBRSwwQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN4QixJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDekIsT0FBTyxFQUFFLElBQUksaUJBQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQVE7WUFDekIsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FDakIsQ0FBQyxDQUFDO0tBQ0osQ0FBQztBQUNKLENBQUM7QUFiRCxvREFhQyJ9